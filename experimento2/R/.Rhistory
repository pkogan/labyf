pacman::p_load(tidyverse,  skimr, readxl)
download.file(url= "https://incuba.fi.uncoma.edu.ar/labyf/experimento2/R/encuesta_experimento.xlsx",
destfile="encuesta_experimento.xlsx")
datos<- read_xlsx("encuesta_experimento.xlsx",
sheet=1,
skip = 7,
col_names = c("unidad_academica",
"edad",
"claustro",
"1_facilidad_BP",
"1_facilidad_BUP",
"1_facilidad_VE",
"2_secreto_BP",
"2_secreto_BUP",
"2_secreto_VE",
"3_integridad_BP",
"3_integridad_BUP",
"3_integridad_VE",
"4_auditabilidad_BP",
"4_auditabilidad_BUP",
"4_auditabilidad_VE",
"5_recomienda_BP",
"5_recomienda_BUP",
"5_recomienda_VE",
"hoja")) %>%
select(-hoja) %>%
mutate_at(vars(starts_with("5")), replace_na, 0)
summary(datos)
borrar <- c("unidad_academica","claustro","edad")
datos2 <- datos[ , !(names(datos) %in% borrar)]
summary(datos2)
skim(datos2)
skim(datos)
boxplot(datos2)
ggplot(datos2,aes( y=value)) +
geom_boxplot(position='dodge', stat='identity') +
ggtitle('Facilidad de Uso') +
xlab('Tipo de sistema') +
ylab('Valor') +
labs(fill='Edades')
boxplot(datos2)
#recodificación edad
datos= datos %>%
mutate (edadr=as.factor(case_when(edad < 25~"Menor de 25",
edad >= 25 & edad <= 34 ~ "Entre 25 y 34",
edad >= 35 & edad <= 44 ~ "Entre 35 y 44",
edad >=45 ~ "De 45 a más"))) %>%
mutate(edadr =fct_relevel(edadr,
c("Menor de 25",
"Entre 25 y 34" ,
"Entre 35 y 44" ,
"De 45 a más"))) %>%
select(-edad)
a= datos %>% group_by(edadr) %>%
summarise_if(is.numeric,mean) %>%
pivot_longer(cols= is.numeric,names_to="variable")
barplot(height=a$value,names=a$variable)
df=a %>% filter(variable %in% c("1_facilidad_BP",
"1_facilidad_BU",
"1_facilidad_BE"))
#Facilidad de Uso
df=a %>% filter(grepl("1",variable, fixed = TRUE))
ggplot(df, aes(fill=edadr, y=value, x=variable)) +
geom_bar(position='dodge', stat='identity') +
ggtitle('Facilidad de Uso') +
xlab('Tipo de sistema') +
ylab('Valor') +
labs(fill='Edades')
titulo="Secreto del voto"
df=a %>% filter(grepl("2",variable, fixed = TRUE))
ggplot(df, aes(fill=edadr, y=value, x=variable)) +
geom_bar(position='dodge', stat='identity') +
ggtitle(titulo) +
xlab('Tipo de sistema') +
ylab('Valor') +
labs(fill='Edades')
setwd("~/Proyectos/labyf/experimento2/R")
download.file(url= "https://incuba.fi.uncoma.edu.ar/labyf/experimento2/R/encuesta_experimento.xlsx",
destfile="encuesta_experimento.xlsx")
